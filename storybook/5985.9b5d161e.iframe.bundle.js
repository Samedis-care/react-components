(self.webpackChunkcomponents_care=self.webpackChunkcomponents_care||[]).push([[5985],{"./src/backend-components/CRUD/Import/GenericDataPreview.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{Z:function(){return Import_GenericDataPreview}});var objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),react=__webpack_require__("./node_modules/react/index.js"),uniqueArray=__webpack_require__("./src/utils/uniqueArray.ts"),filterSortPaginate=__webpack_require__("./src/utils/filterSortPaginate.ts"),StatePersistence=__webpack_require__("./src/standalone/DataGrid/StatePersistence.tsx"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),NoPersist=function NoPersist(props){var children=props.children;return(0,jsx_runtime.jsx)(StatePersistence.j.Provider,{value:void 0,children:children})},DataGrid_NoPersist=react.memo(NoPersist);try{NoPersist.displayName="NoPersist",NoPersist.__docgenInfo={description:"Clears the current persistence provider for DataGrid.",displayName:"NoPersist",props:{children:{defaultValue:null,description:"The children to render",name:"children",required:!0,type:{name:"ReactNode"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/standalone/DataGrid/NoPersist.tsx#NoPersist"]={docgenInfo:NoPersist.__docgenInfo,name:"NoPersist",path:"src/standalone/DataGrid/NoPersist.tsx#NoPersist"})}catch(__react_docgen_typescript_loader_error){}var DataGrid=__webpack_require__("./src/standalone/DataGrid/DataGrid.tsx"),GenericDataPreview=function GenericDataPreview(props){var data=props.data,existingDefinition=props.existingDefinition,defaultFilter=props.defaultFilter,columns=(0,react.useMemo)((function(){return(0,uniqueArray.Z)(data.map(Object.keys).flat())}),[data]),columnDef=(0,react.useMemo)((function(){return columns.map((function(column){var _existingDefinition$f;return null!==(_existingDefinition$f=null==existingDefinition?void 0:existingDefinition.find((function(entry){return entry.field===column})))&&void 0!==_existingDefinition$f?_existingDefinition$f:{field:column,headerName:column,type:"string",hidden:!1,filterable:!0,sortable:!0,isLocked:!1}}))}),[existingDefinition,columns]),rowData=(0,react.useMemo)((function(){return data.map((function(entry,index){return(0,objectSpread2.Z)({id:index.toString(16)},entry)}))}),[data]);return(0,jsx_runtime.jsx)(DataGrid_NoPersist,{children:(0,jsx_runtime.jsx)(DataGrid.ZP,{columns:columnDef,disableSelection:!0,loadData:function loadData(params){var processed=(0,filterSortPaginate.Z)(rowData,params,columnDef);return{rowsTotal:rowData.length,rowsFiltered:processed[1],rows:processed[0]}},defaultFilter:defaultFilter})})},Import_GenericDataPreview=react.memo(GenericDataPreview);try{GenericDataPreview.displayName="GenericDataPreview",GenericDataPreview.__docgenInfo={description:"",displayName:"GenericDataPreview",props:{data:{defaultValue:null,description:"The generic data, should be a Record<string, GenericDataType>",name:"data",required:!0,type:{name:"Record<string, unknown>[]"}},existingDefinition:{defaultValue:null,description:"Existing (partial) column definition",name:"existingDefinition",required:!1,type:{name:"IDataGridColumnDef[]"}},defaultFilter:{defaultValue:null,description:"Default filter settings",name:"defaultFilter",required:!1,type:{name:"DataGridFilterSetting[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/backend-components/CRUD/Import/GenericDataPreview.tsx#GenericDataPreview"]={docgenInfo:GenericDataPreview.__docgenInfo,name:"GenericDataPreview",path:"src/backend-components/CRUD/Import/GenericDataPreview.tsx#GenericDataPreview"})}catch(__react_docgen_typescript_loader_error){}},"./src/backend-components/CRUD/Import/Step2ConnectData.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var _home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_index__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__("./src/backend-components/CRUD/Import/index.tsx"),_material_ui_core__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@material-ui/core/esm/styles/makeStyles.js"),_material_ui_core__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./node_modules/@material-ui/core/esm/Grid/Grid.js"),_material_ui_core__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@material-ui/core/esm/Box/Box.js"),_material_ui_core__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./node_modules/@material-ui/core/esm/Typography/Typography.js"),_material_ui_core__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/@material-ui/core/esm/Table/Table.js"),_material_ui_core__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./node_modules/@material-ui/core/esm/TableHead/TableHead.js"),_material_ui_core__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./node_modules/@material-ui/core/esm/TableRow/TableRow.js"),_material_ui_core__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__("./node_modules/@material-ui/core/esm/TableCell/TableCell.js"),_material_ui_core__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__("./node_modules/@material-ui/core/esm/TableBody/TableBody.js"),_material_ui_core__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__("./node_modules/@material-ui/core/esm/Card/Card.js"),_material_ui_core__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__("./node_modules/@material-ui/core/esm/CardContent/CardContent.js"),_material_ui_core__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__("./node_modules/@material-ui/core/esm/Tooltip/Tooltip.js"),_material_ui_core__WEBPACK_IMPORTED_MODULE_25__=__webpack_require__("./node_modules/@material-ui/core/esm/CircularProgress/CircularProgress.js"),_material_ui_core__WEBPACK_IMPORTED_MODULE_28__=__webpack_require__("./node_modules/@material-ui/core/esm/TextField/TextField.js"),_material_ui_icons__WEBPACK_IMPORTED_MODULE_24__=__webpack_require__("./node_modules/@material-ui/icons/esm/Check.js"),_material_ui_icons__WEBPACK_IMPORTED_MODULE_26__=__webpack_require__("./node_modules/@material-ui/icons/esm/ErrorOutline.js"),_material_ui_icons__WEBPACK_IMPORTED_MODULE_27__=__webpack_require__("./node_modules/@material-ui/icons/esm/HelpOutline.js"),_utils__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./src/utils/uniqueArray.ts"),_utils__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/utils/debouncePromise.ts"),_utils_useCCTranslations__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/utils/useCCTranslations.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js"),useStyles=(0,_material_ui_core__WEBPACK_IMPORTED_MODULE_3__.Z)({scriptInput:{"& textarea":{fontFamily:"monospace"}},monospace:{fontFamily:"monospace"},cardContent:{paddingBottom:4,"&:last-child":{paddingBottom:4}}},{name:"CcCrudImportStep2"}),useImportStep2Logic=function useImportStep2Logic(props){var model=props.model,state=props.state,setState=props.setState,_useCCTranslations=(0,_utils_useCCTranslations__WEBPACK_IMPORTED_MODULE_4__.ZP)(),t=_useCCTranslations.t,columns=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((function(){return(0,_utils__WEBPACK_IMPORTED_MODULE_5__.Z)(state.data.map(Object.keys).flat())}),[state.data]),conversionScriptUpdates=(0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(Object.fromEntries(Object.keys(model.fields).map((function(key){return[key,(0,_utils__WEBPACK_IMPORTED_MODULE_6__.Z)(function(){var _ref=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_7__.Z)(_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee(data,field,script){var _iterator,_step,_eval,record,result,validation;return _home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:_iterator=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_createForOfIteratorHelper_js__WEBPACK_IMPORTED_MODULE_8__.Z)(data),_context.prev=1,_iterator.s();case 3:if((_step=_iterator.n()).done){_context.next=29;break}record=_step.value,result=null!==(_eval=eval(script))&&void 0!==_eval?_eval:null,validation=null,_context.t0=field.type.getFilterType(),_context.next="enum"===_context.t0||"string"===_context.t0?10:"number"===_context.t0?12:"currency"===_context.t0?14:"date"===_context.t0?16:"boolean"===_context.t0?18:20;break;case 10:return null!=result&&"string"!=typeof result&&(validation=t("backend-components.crud.import.validations.string")),_context.abrupt("break",20);case 12:return null!=result&&"number"!=typeof result&&(validation=t("backend-components.crud.import.validations.number")),_context.abrupt("break",20);case 14:return null!==result&&(validation=t("backend-components.crud.import.validations.currency_unsupported")),_context.abrupt("break",20);case 16:return null===result||result instanceof Date||(validation=t("backend-components.crud.import.validations.date")),_context.abrupt("break",20);case 18:return!0!==result&&!1!==result&&null!==result&&(validation=t("backend-components.crud.import.validations.boolean")),_context.abrupt("break",20);case 20:if(validation){_context.next=24;break}return _context.next=23,field.type.validate(result);case 23:validation=_context.sent;case 24:if(!validation){_context.next=27;break}throw console.error("Validation failed:",validation,"; Result =",result,"; Record =",record),new Error(t("backend-components.crud.import.validations.fail",{REASON:validation}));case 27:_context.next=3;break;case 29:_context.next=34;break;case 31:_context.prev=31,_context.t1=_context.catch(1),_iterator.e(_context.t1);case 34:return _context.prev=34,_iterator.f(),_context.finish(34);case 37:case"end":return _context.stop()}}),_callee,null,[[1,31,34,37]])})));return function(_x,_x2,_x3){return _ref.apply(this,arguments)}}(),1e3)]})))),handleConversionScriptChange=(0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)(function(){var _ref2=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_7__.Z)(_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee2(evt){return _home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return setState((function(prev){return(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__.Z)((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__.Z)({},prev),{},{conversionScripts:(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__.Z)((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__.Z)({},prev.conversionScripts),{},(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_10__.Z)({},evt.target.name,{script:evt.target.value,status:"pending",error:null}))})})),_context2.prev=1,_context2.next=4,conversionScriptUpdates.current[evt.target.name](state.data,model.fields[evt.target.name],evt.target.value);case 4:setState((function(prev){return(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__.Z)((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__.Z)({},prev),{},{conversionScripts:(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__.Z)((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__.Z)({},prev.conversionScripts),{},(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_10__.Z)({},evt.target.name,(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__.Z)((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__.Z)({},prev.conversionScripts[evt.target.name]),{},{status:"okay",error:null})))})})),_context2.next=10;break;case 7:_context2.prev=7,_context2.t0=_context2.catch(1),setState((function(prev){return(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__.Z)((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__.Z)({},prev),{},{conversionScripts:(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__.Z)((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__.Z)({},prev.conversionScripts),{},(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_10__.Z)({},evt.target.name,(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__.Z)((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_9__.Z)({},prev.conversionScripts[evt.target.name]),{},{status:"error",error:_context2.t0})))})}));case 10:case"end":return _context2.stop()}}),_callee2,null,[[1,7]])})));return function(_x4){return _ref2.apply(this,arguments)}}(),[model.fields,setState,state.data]);return{columns:columns,conversionScriptUpdates:conversionScriptUpdates,handleConversionScriptChange:handleConversionScriptChange}},Step2ConnectData=function Step2ConnectData(props){var model=props.model,state=props.state,classes=useStyles(),t=(0,_utils_useCCTranslations__WEBPACK_IMPORTED_MODULE_4__.ZP)().t,_useImportStep2Logic=useImportStep2Logic(props),columns=_useImportStep2Logic.columns,handleConversionScriptChange=_useImportStep2Logic.handleConversionScriptChange;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_material_ui_core__WEBPACK_IMPORTED_MODULE_11__.Z,{container:!0,spacing:2,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_material_ui_core__WEBPACK_IMPORTED_MODULE_11__.Z,{item:!0,xs:6,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_12__.Z,{mb:2,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_13__.Z,{variant:"h5",children:t("backend-components.crud.import.source_fields")})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_material_ui_core__WEBPACK_IMPORTED_MODULE_14__.Z,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_15__.Z,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_material_ui_core__WEBPACK_IMPORTED_MODULE_16__.Z,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_17__.Z,{children:t("backend-components.crud.import.source_field")}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_17__.Z,{children:t("backend-components.crud.import.source_field_type")})]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_18__.Z,{children:columns.map((function(column){var dataTypes=(0,_utils__WEBPACK_IMPORTED_MODULE_5__.Z)(state.data.map((function(record){return typeof record[column]}))).sort();return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_material_ui_core__WEBPACK_IMPORTED_MODULE_16__.Z,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_17__.Z,{className:classes.monospace,children:'record["'.concat(column,'"]')}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_17__.Z,{children:dataTypes.join(", ")})]},column)}))})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_material_ui_core__WEBPACK_IMPORTED_MODULE_11__.Z,{item:!0,xs:6,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_12__.Z,{mb:2,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_13__.Z,{variant:"h5",children:t("backend-components.crud.import.destination_fields")})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_11__.Z,{container:!0,spacing:2,children:Object.entries(model.fields).filter((function(_ref3){var _ref4=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_19__.Z)(_ref3,2),name=_ref4[0],field=_ref4[1];return(0,_index__WEBPACK_IMPORTED_MODULE_20__.isFieldImportable)(name,field)})).map((function(_ref5){var _convScript$error$toS,_convScript$error,_t,_convScript$script,_ref6=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_19__.Z)(_ref5,2),name=_ref6[0],field=_ref6[1],convScript=state.conversionScripts[name];return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_11__.Z,{item:!0,xs:12,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_21__.Z,{children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_material_ui_core__WEBPACK_IMPORTED_MODULE_22__.Z,{className:classes.cardContent,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_material_ui_core__WEBPACK_IMPORTED_MODULE_11__.Z,{container:!0,justify:"space-between",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_material_ui_core__WEBPACK_IMPORTED_MODULE_11__.Z,{item:!0,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_13__.Z,{children:field.getLabel()?"".concat(field.getLabel()," (").concat(name,")"):name}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_13__.Z,{color:"textSecondary",children:field.type.getFilterType()})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_11__.Z,{item:!0,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_23__.ZP,{title:convScript?null!==(_convScript$error$toS=null===(_convScript$error=convScript.error)||void 0===_convScript$error?void 0:_convScript$error.toString())&&void 0!==_convScript$error$toS?_convScript$error$toS:"":null!==(_t=t("backend-components.crud.import.validations.unknown"))&&void 0!==_t?_t:"",children:convScript?"okay"===convScript.status?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_icons__WEBPACK_IMPORTED_MODULE_24__.Z,{}):"pending"===convScript.status?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_25__.Z,{}):"error"===convScript.status?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_icons__WEBPACK_IMPORTED_MODULE_26__.Z,{}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_icons__WEBPACK_IMPORTED_MODULE_27__.Z,{}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_icons__WEBPACK_IMPORTED_MODULE_27__.Z,{})})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_11__.Z,{item:!0,xs:12,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_material_ui_core__WEBPACK_IMPORTED_MODULE_12__.Z,{mt:2,children:[(null==convScript?void 0:convScript.error)&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_13__.Z,{children:convScript.error.toString()}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_28__.Z,{multiline:!0,label:t("backend-components.crud.import.conv_script"),name:name,value:null!==(_convScript$script=null==convScript?void 0:convScript.script)&&void 0!==_convScript$script?_convScript$script:"",onChange:handleConversionScriptChange,placeholder:"".concat(name," = "),className:classes.scriptInput,fullWidth:!0})]})})]})})},name)}))})]})]})};__webpack_exports__.Z=react__WEBPACK_IMPORTED_MODULE_1__.memo(Step2ConnectData);try{useImportStep2Logic.displayName="useImportStep2Logic",useImportStep2Logic.__docgenInfo={description:"",displayName:"useImportStep2Logic",props:{model:{defaultValue:null,description:"",name:"model",required:!0,type:{name:"Model<string, PageVisibility, unknown>"}},updateKey:{defaultValue:null,description:"",name:"updateKey",required:!0,type:{name:"string | undefined"}},additionalUpdateKeyFilters:{defaultValue:null,description:"",name:"additionalUpdateKeyFilters",required:!0,type:{name:"Record<string, unknown> | undefined"}},hasImportConfig:{defaultValue:null,description:"",name:"hasImportConfig",required:!0,type:{name:"boolean"}},validate:{defaultValue:null,description:"",name:"validate",required:!0,type:{name:"((record: Record<string, unknown>) => ValidationError | Promise<ValidationError>) | undefined"}},state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"CrudImporterState"}},setState:{defaultValue:null,description:"",name:"setState",required:!0,type:{name:"Dispatch<SetStateAction<CrudImporterState>>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/backend-components/CRUD/Import/Step2ConnectData.tsx#useImportStep2Logic"]={docgenInfo:useImportStep2Logic.__docgenInfo,name:"useImportStep2Logic",path:"src/backend-components/CRUD/Import/Step2ConnectData.tsx#useImportStep2Logic"})}catch(__react_docgen_typescript_loader_error){}try{Step2ConnectData.displayName="Step2ConnectData",Step2ConnectData.__docgenInfo={description:"",displayName:"Step2ConnectData",props:{model:{defaultValue:null,description:"",name:"model",required:!0,type:{name:"Model<string, PageVisibility, unknown>"}},updateKey:{defaultValue:null,description:"",name:"updateKey",required:!0,type:{name:"string | undefined"}},additionalUpdateKeyFilters:{defaultValue:null,description:"",name:"additionalUpdateKeyFilters",required:!0,type:{name:"Record<string, unknown> | undefined"}},hasImportConfig:{defaultValue:null,description:"",name:"hasImportConfig",required:!0,type:{name:"boolean"}},validate:{defaultValue:null,description:"",name:"validate",required:!0,type:{name:"((record: Record<string, unknown>) => ValidationError | Promise<ValidationError>) | undefined"}},state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"CrudImporterState"}},setState:{defaultValue:null,description:"",name:"setState",required:!0,type:{name:"Dispatch<SetStateAction<CrudImporterState>>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/backend-components/CRUD/Import/Step2ConnectData.tsx#Step2ConnectData"]={docgenInfo:Step2ConnectData.__docgenInfo,name:"Step2ConnectData",path:"src/backend-components/CRUD/Import/Step2ConnectData.tsx#Step2ConnectData"})}catch(__react_docgen_typescript_loader_error){}},"./src/backend-components/CRUD/Import/Step3ValidateReview.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var _home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/toConsumableArray.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_index__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./src/backend-components/CRUD/Import/index.tsx"),_GenericDataPreview__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./src/backend-components/CRUD/Import/GenericDataPreview.tsx"),_utils__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/utils/deepAssign.ts"),_utils__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./src/utils/dotUtils.ts"),_utils__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./src/utils/isObjectEmpty.ts"),_utils_useAsyncMemo__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/utils/useAsyncMemo.ts"),_utils_useCCTranslations__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/utils/useCCTranslations.ts"),_standalone__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./src/standalone/Loader/index.tsx"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js"),useImportStep3Logic=function useImportStep3Logic(props){var model=props.model,state=props.state,setState=props.setState,validate=props.validate,_useCCTranslations=(0,_utils_useCCTranslations__WEBPACK_IMPORTED_MODULE_3__.ZP)(),t=_useCCTranslations.t,records=(0,_utils_useAsyncMemo__WEBPACK_IMPORTED_MODULE_4__.Z)((function(){return Promise.all(state.data.map(function(){var _ref=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_5__.Z)(_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee(record){var modelRecord,isModelRecordComplete,validation;return _home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return modelRecord={},isModelRecordComplete=!1,_context.prev=2,Object.entries(model.fields).filter((function(_ref2){var _state$conversionScri,_ref3=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_6__.Z)(_ref2,2),name=_ref3[0],field=_ref3[1];return(0,_index__WEBPACK_IMPORTED_MODULE_7__.isFieldImportable)(name,field)&&(null===(_state$conversionScri=state.conversionScripts[name])||void 0===_state$conversionScri?void 0:_state$conversionScri.script)})).forEach((function(_ref4){var _eval,_ref5=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_6__.Z)(_ref4,1),name=_ref5[0];(0,_utils__WEBPACK_IMPORTED_MODULE_8__.Z)(modelRecord,(0,_utils__WEBPACK_IMPORTED_MODULE_9__.Kb)(name,null!==(_eval=eval(state.conversionScripts[name].script))&&void 0!==_eval?_eval:null))})),isModelRecordComplete=!0,_context.next=7,model.validate(modelRecord);case 7:if(validation=_context.sent,_context.t0=modelRecord,!validate){_context.next=21;break}return _context.t2=_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z,_context.t3=_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z,_context.t4={},_context.next=15,validate(modelRecord);case 15:_context.t5=_context.sent,_context.t6=(0,_context.t3)(_context.t4,_context.t5),_context.t7=validation,_context.t1=(0,_context.t2)(_context.t6,_context.t7),_context.next=22;break;case 21:_context.t1=validation;case 22:return _context.t8=_context.t1,_context.abrupt("return",[_context.t0,_context.t8,null]);case 26:return _context.prev=26,_context.t9=_context.catch(2),_context.abrupt("return",[isModelRecordComplete?modelRecord:record,{},_context.t9]);case 29:case"end":return _context.stop()}}),_callee,null,[[2,26]])})));return function(_x){return _ref.apply(this,arguments)}}()))}),[model,state.conversionScripts,state.data]),recordsNormalized=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((function(){return(null!=records?records:[]).map((function(record){var _error$toString,_record=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_6__.Z)(record,3),data=_record[0],validation=_record[1],error=_record[2],updateKey=props.updateKey;updateKey&&!(updateKey in validation)&&data[updateKey]&&((null!=records?records:[]).filter((function(r){return r[0][updateKey]===data[updateKey]})).length>1&&(validation[updateKey]=t("backend-components.crud.import.errors.update-key-not-uniq",{UPDATE_KEY:model.fields[updateKey].getLabel()})));return(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z)({valid:(0,_utils__WEBPACK_IMPORTED_MODULE_11__.Z)(validation)?"true":Object.entries(validation).map((function(_ref6){var _ref7=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_6__.Z)(_ref6,2);return _ref7[0]+": "+_ref7[1]})).join("; "),error:null!==(_error$toString=null==error?void 0:error.toString())&&void 0!==_error$toString?_error$toString:"none"},data)}))}),[model.fields,props.updateKey,records,t]),everythingOkay=(0,react__WEBPACK_IMPORTED_MODULE_1__.useMemo)((function(){return!!records&&!records.find((function(record){return!(0,_utils__WEBPACK_IMPORTED_MODULE_11__.Z)(record[1])||record[2]}))}),[records]);return(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){setState((function(prev){return(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z)((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z)({},prev),{},{validationPassed:everythingOkay})}))}),[setState,everythingOkay]),{records:records,recordsNormalized:recordsNormalized,everythingOkay:everythingOkay}},Step3ValidateReview=function Step3ValidateReview(props){var model=props.model,_useImportStep3Logic=useImportStep3Logic(props),records=_useImportStep3Logic.records,recordsNormalized=_useImportStep3Logic.recordsNormalized,everythingOkay=_useImportStep3Logic.everythingOkay,t=(0,_utils_useCCTranslations__WEBPACK_IMPORTED_MODULE_3__.ZP)().t;return records?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_GenericDataPreview__WEBPACK_IMPORTED_MODULE_13__.Z,{data:recordsNormalized,existingDefinition:[].concat((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_toConsumableArray_js__WEBPACK_IMPORTED_MODULE_14__.Z)(model.toDataGridColumnDefinition().map((function(columnDef){return(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z)((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_10__.Z)({},columnDef),{},{filterable:!0,sortable:!0,isLocked:!1,hidden:!1})}))),[{field:"valid",type:"string",headerName:t("backend-components.crud.import.valid"),filterable:!0,sortable:!0,isLocked:!1,hidden:!1},{field:"error",type:"string",headerName:t("backend-components.crud.import.error"),filterable:!0,sortable:!0,isLocked:!1,hidden:!1}]),defaultFilter:everythingOkay?[]:[{field:"valid",filter:{type:"notEqual",value1:"true",value2:""}}]}):(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_standalone__WEBPACK_IMPORTED_MODULE_12__.Z,{})};__webpack_exports__.Z=react__WEBPACK_IMPORTED_MODULE_1__.memo(Step3ValidateReview);try{useImportStep3Logic.displayName="useImportStep3Logic",useImportStep3Logic.__docgenInfo={description:"",displayName:"useImportStep3Logic",props:{model:{defaultValue:null,description:"",name:"model",required:!0,type:{name:"Model<string, PageVisibility, unknown>"}},updateKey:{defaultValue:null,description:"",name:"updateKey",required:!0,type:{name:"string | undefined"}},additionalUpdateKeyFilters:{defaultValue:null,description:"",name:"additionalUpdateKeyFilters",required:!0,type:{name:"Record<string, unknown> | undefined"}},hasImportConfig:{defaultValue:null,description:"",name:"hasImportConfig",required:!0,type:{name:"boolean"}},validate:{defaultValue:null,description:"",name:"validate",required:!0,type:{name:"((record: Record<string, unknown>) => ValidationError | Promise<ValidationError>) | undefined"}},state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"CrudImporterState"}},setState:{defaultValue:null,description:"",name:"setState",required:!0,type:{name:"Dispatch<SetStateAction<CrudImporterState>>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/backend-components/CRUD/Import/Step3ValidateReview.tsx#useImportStep3Logic"]={docgenInfo:useImportStep3Logic.__docgenInfo,name:"useImportStep3Logic",path:"src/backend-components/CRUD/Import/Step3ValidateReview.tsx#useImportStep3Logic"})}catch(__react_docgen_typescript_loader_error){}try{Step3ValidateReview.displayName="Step3ValidateReview",Step3ValidateReview.__docgenInfo={description:"",displayName:"Step3ValidateReview",props:{model:{defaultValue:null,description:"",name:"model",required:!0,type:{name:"Model<string, PageVisibility, unknown>"}},updateKey:{defaultValue:null,description:"",name:"updateKey",required:!0,type:{name:"string | undefined"}},additionalUpdateKeyFilters:{defaultValue:null,description:"",name:"additionalUpdateKeyFilters",required:!0,type:{name:"Record<string, unknown> | undefined"}},hasImportConfig:{defaultValue:null,description:"",name:"hasImportConfig",required:!0,type:{name:"boolean"}},validate:{defaultValue:null,description:"",name:"validate",required:!0,type:{name:"((record: Record<string, unknown>) => ValidationError | Promise<ValidationError>) | undefined"}},state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"CrudImporterState"}},setState:{defaultValue:null,description:"",name:"setState",required:!0,type:{name:"Dispatch<SetStateAction<CrudImporterState>>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/backend-components/CRUD/Import/Step3ValidateReview.tsx#Step3ValidateReview"]={docgenInfo:Step3ValidateReview.__docgenInfo,name:"Step3ValidateReview",path:"src/backend-components/CRUD/Import/Step3ValidateReview.tsx#Step3ValidateReview"})}catch(__react_docgen_typescript_loader_error){}},"./src/backend-components/CRUD/Import/Step4Import.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var _home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/defineProperty.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js"),_index__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__("./src/backend-components/CRUD/Import/index.tsx"),_material_ui_core__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__("./node_modules/@material-ui/core/esm/Grid/Grid.js"),_material_ui_core__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__("./node_modules/@material-ui/core/esm/Typography/Typography.js"),_material_ui_core__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__("./node_modules/@material-ui/core/esm/TextField/TextField.js"),_backend_integration__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/backend-integration/Model/Model.ts"),_backend_integration__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./src/backend-integration/Model/Visibilities/VisibilityHidden.ts"),_utils__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./src/utils/sleep.ts"),_utils__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__("./src/utils/deepAssign.ts"),_utils__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__("./src/utils/dotUtils.ts"),_utils_useCCTranslations__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__("./src/utils/useCCTranslations.ts"),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/jsx-runtime.js"),useImportStep4Logic=function useImportStep4Logic(props){var model=props.model,state=props.state,setState=props.setState,updateKey=props.updateKey,additionalUpdateKeyFilters=props.additionalUpdateKeyFilters,customModel=new _backend_integration__WEBPACK_IMPORTED_MODULE_3__.ZP(model.modelId,Object.fromEntries(Object.entries(model.fields).map((function(_ref){var _ref2=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(_ref,2),key=_ref2[0],field=_ref2[1];return[key,(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.Z)((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.Z)({},field),{},{visibility:(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.Z)((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.Z)({},field.visibility),{},{create:_backend_integration__WEBPACK_IMPORTED_MODULE_6__.Z})})]}))),model.connector,model.cacheKeys,model.cacheOptions),_useModelMutation=(0,_backend_integration__WEBPACK_IMPORTED_MODULE_3__.er)(customModel),createOrUpdateRecord=_useModelMutation.mutateAsync,_useState=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(!1),_useState2=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(_useState,2),importDone=_useState2[0],setImportDone=_useState2[1];(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){setState((function(prev){return(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.Z)((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.Z)({},prev),{},{importDone:importDone})}))}),[setState,importDone]);var _useState3=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)({todo:0,success:0,failed:0}),_useState4=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(_useState3,2),counters=_useState4[0],setCounters=_useState4[1],_useState5=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(""),_useState6=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(_useState5,2),lastError=_useState6[0],setLastError=_useState6[1];return(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_7__.Z)(_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee2(){var activeRequests;return _home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return setCounters({todo:state.data.length,success:0,failed:0}),activeRequests=0,_context2.next=4,Promise.all(state.data.map(function(){var _ref4=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_7__.Z)(_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee(record){var modelRecord,filterKey,_meta$filteredRows,_yield$model$index,_yield$model$index2,records,meta,rows;return _home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!(activeRequests>=10)){_context.next=5;break}return _context.next=3,(0,_utils__WEBPACK_IMPORTED_MODULE_8__.Z)(50);case 3:_context.next=0;break;case 5:if(activeRequests++,modelRecord={},_context.prev=7,Object.entries(model.fields).filter((function(_ref5){var _ref6=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(_ref5,2),name=_ref6[0],field=_ref6[1];return(0,_index__WEBPACK_IMPORTED_MODULE_9__.isFieldImportable)(name,field)})).forEach((function(_ref7){var _eval,_state$conversionScri,_state$conversionScri2,_ref8=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(_ref7,1),name=_ref8[0];(0,_utils__WEBPACK_IMPORTED_MODULE_10__.Z)(modelRecord,(0,_utils__WEBPACK_IMPORTED_MODULE_11__.Kb)(name,null!==(_eval=eval(null!==(_state$conversionScri=null===(_state$conversionScri2=state.conversionScripts[name])||void 0===_state$conversionScri2?void 0:_state$conversionScri2.script)&&void 0!==_state$conversionScri?_state$conversionScri:""))&&void 0!==_eval?_eval:null))})),!updateKey){_context.next=25;break}if(filterKey=model.fields[updateKey].type.stringify((0,_utils__WEBPACK_IMPORTED_MODULE_11__.VG)(updateKey,modelRecord)),!filterKey){_context.next=25;break}return _context.next=14,model.index({rows:2,page:1,fieldFilter:(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_12__.Z)({},updateKey,{type:"equals",value1:filterKey,value2:""}),additionalFilters:additionalUpdateKeyFilters});case 14:if(_yield$model$index=_context.sent,_yield$model$index2=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_4__.Z)(_yield$model$index,2),records=_yield$model$index2[0],meta=_yield$model$index2[1],rows=null!==(_meta$filteredRows=meta.filteredRows)&&void 0!==_meta$filteredRows?_meta$filteredRows:meta.totalRows,1!=rows){_context.next=23;break}modelRecord.id=records[0].id,_context.next=25;break;case 23:if(!(rows>=2)){_context.next=25;break}throw new Error("Update key not unique: "+filterKey);case 25:return _context.next=27,createOrUpdateRecord(modelRecord);case 27:setCounters((function(prev){return(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.Z)((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.Z)({},prev),{},{success:prev.success+1})})),_context.next=35;break;case 30:_context.prev=30,_context.t0=_context.catch(7),console.error(_context.t0),setCounters((function(prev){return(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.Z)((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.Z)({},prev),{},{failed:prev.failed+1})})),setLastError(JSON.stringify({error:_context.t0.toString(),destRecord:modelRecord,sourceRecord:record},void 0,4));case 35:return _context.prev=35,setCounters((function(prev){return(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.Z)((0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_objectSpread2_js__WEBPACK_IMPORTED_MODULE_5__.Z)({},prev),{},{todo:prev.todo-1})})),activeRequests--,_context.finish(35);case 39:case"end":return _context.stop()}}),_callee,null,[[7,30,35,39]])})));return function(_x){return _ref4.apply(this,arguments)}}()));case 4:setImportDone(!0);case 5:case"end":return _context2.stop()}}),_callee2)})))()}),[]),{counters:counters,lastError:lastError}},Step4Import=function Step4Import(props){var _useImportStep4Logic=useImportStep4Logic(props),counters=_useImportStep4Logic.counters,lastError=_useImportStep4Logic.lastError,t=(0,_utils_useCCTranslations__WEBPACK_IMPORTED_MODULE_13__.ZP)().t;return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsxs)(_material_ui_core__WEBPACK_IMPORTED_MODULE_14__.Z,{container:!0,spacing:2,children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_14__.Z,{item:!0,xs:12,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_15__.Z,{children:t("backend-components.crud.import.queue",{COUNT:counters.todo})})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_14__.Z,{item:!0,xs:12,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_15__.Z,{children:t("backend-components.crud.import.success",{COUNT:counters.success})})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_14__.Z,{item:!0,xs:12,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_15__.Z,{children:t("backend-components.crud.import.failed",{COUNT:counters.failed})})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_14__.Z,{item:!0,xs:12,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_2__.jsx)(_material_ui_core__WEBPACK_IMPORTED_MODULE_16__.Z,{multiline:!0,fullWidth:!0,label:t("backend-components.crud.import.last_error"),value:lastError})})]})};__webpack_exports__.Z=react__WEBPACK_IMPORTED_MODULE_1__.memo(Step4Import);try{useImportStep4Logic.displayName="useImportStep4Logic",useImportStep4Logic.__docgenInfo={description:"",displayName:"useImportStep4Logic",props:{model:{defaultValue:null,description:"",name:"model",required:!0,type:{name:"Model<string, PageVisibility, unknown>"}},updateKey:{defaultValue:null,description:"",name:"updateKey",required:!0,type:{name:"string | undefined"}},additionalUpdateKeyFilters:{defaultValue:null,description:"",name:"additionalUpdateKeyFilters",required:!0,type:{name:"Record<string, unknown> | undefined"}},hasImportConfig:{defaultValue:null,description:"",name:"hasImportConfig",required:!0,type:{name:"boolean"}},validate:{defaultValue:null,description:"",name:"validate",required:!0,type:{name:"((record: Record<string, unknown>) => ValidationError | Promise<ValidationError>) | undefined"}},state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"CrudImporterState"}},setState:{defaultValue:null,description:"",name:"setState",required:!0,type:{name:"Dispatch<SetStateAction<CrudImporterState>>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/backend-components/CRUD/Import/Step4Import.tsx#useImportStep4Logic"]={docgenInfo:useImportStep4Logic.__docgenInfo,name:"useImportStep4Logic",path:"src/backend-components/CRUD/Import/Step4Import.tsx#useImportStep4Logic"})}catch(__react_docgen_typescript_loader_error){}try{Step4Import.displayName="Step4Import",Step4Import.__docgenInfo={description:"",displayName:"Step4Import",props:{model:{defaultValue:null,description:"",name:"model",required:!0,type:{name:"Model<string, PageVisibility, unknown>"}},updateKey:{defaultValue:null,description:"",name:"updateKey",required:!0,type:{name:"string | undefined"}},additionalUpdateKeyFilters:{defaultValue:null,description:"",name:"additionalUpdateKeyFilters",required:!0,type:{name:"Record<string, unknown> | undefined"}},hasImportConfig:{defaultValue:null,description:"",name:"hasImportConfig",required:!0,type:{name:"boolean"}},validate:{defaultValue:null,description:"",name:"validate",required:!0,type:{name:"((record: Record<string, unknown>) => ValidationError | Promise<ValidationError>) | undefined"}},state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"CrudImporterState"}},setState:{defaultValue:null,description:"",name:"setState",required:!0,type:{name:"Dispatch<SetStateAction<CrudImporterState>>"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/backend-components/CRUD/Import/Step4Import.tsx#Step4Import"]={docgenInfo:Step4Import.__docgenInfo,name:"Step4Import",path:"src/backend-components/CRUD/Import/Step4Import.tsx#Step4Import"})}catch(__react_docgen_typescript_loader_error){}},"./src/backend-components/CRUD/Import/index.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{IMPORT_STEPS:function(){return IMPORT_STEPS},default:function(){return CRUD_Import},isFieldImportable:function(){return isFieldImportable},useCrudImportLogic:function(){return useCrudImportLogic}});var slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),react=__webpack_require__("./node_modules/react/index.js"),makeStyles=__webpack_require__("./node_modules/@material-ui/core/esm/styles/makeStyles.js"),Grid=__webpack_require__("./node_modules/@material-ui/core/esm/Grid/Grid.js"),Stepper=__webpack_require__("./node_modules/@material-ui/core/esm/Stepper/Stepper.js"),Step=__webpack_require__("./node_modules/@material-ui/core/esm/Step/Step.js"),StepLabel=__webpack_require__("./node_modules/@material-ui/core/esm/StepLabel/StepLabel.js"),Button=__webpack_require__("./node_modules/@material-ui/core/esm/Button/Button.js"),objectSpread2=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/objectSpread2.js"),asyncToGenerator=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),regenerator=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),xlsx=__webpack_require__("./node_modules/xlsx/xlsx.js"),xlsx_default=__webpack_require__.n(xlsx),GenericDataPreview=__webpack_require__("./src/backend-components/CRUD/Import/GenericDataPreview.tsx"),DialogContextProvider=__webpack_require__("./src/framework/DialogContextProvider.tsx"),HowToBox=__webpack_require__("./src/standalone/HowToBox/index.tsx"),Generic=__webpack_require__("./src/standalone/FileUpload/Generic/index.tsx"),Utils=__webpack_require__("./src/non-standalone/Dialog/Utils.tsx"),useCCTranslations=__webpack_require__("./src/utils/useCCTranslations.ts"),jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),useImportStep1FileUploadProps=function useImportStep1FileUploadProps(props){var state=props.state,setState=props.setState,_useDialogContext=(0,DialogContextProvider.DA)(),pushDialog=(0,slicedToArray.Z)(_useDialogContext,1)[0],t=(0,useCCTranslations.ZP)().t,handleChange=(0,react.useCallback)((function(files){(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var importableFiles,workbooks,json;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return importableFiles=files.filter((function(file){return file.canBeUploaded})),_context.next=3,Promise.all(importableFiles.map((function(file){return new Promise((function(resolve,reject){var reader=new FileReader;reader.addEventListener("load",(function(){try{var data=reader.result,workbook=xlsx_default().read(data,{type:"array",cellDates:!0});resolve(workbook)}catch(e){reject(e)}})),reader.addEventListener("error",reject),reader.readAsArrayBuffer(file.file)}))})));case 3:workbooks=_context.sent,json=workbooks.map((function(book){return Object.values(book.Sheets).map((function(sheet){for(var cellref in sheet){var c=sheet[cellref];"d"===c.t&&(delete c.w,delete c.z)}return xlsx_default().utils.sheet_to_json(sheet,{dateNF:'YYYY-MM-DD"T"hh:mm:ss',raw:!1,rawNumbers:!0,defval:void 0,blankrows:!1}).map((function(record){return Object.fromEntries(Object.entries(record).map((function(_ref2){var _ref3=(0,slicedToArray.Z)(_ref2,2),k=_ref3[0],v=_ref3[1];return[k,"number"==typeof v?v.toString():v]})))}))})).flat()})).flat(),setState((function(prev){return(0,objectSpread2.Z)((0,objectSpread2.Z)({},prev),{},{files:files,data:json})}));case 6:case"end":return _context.stop()}}),_callee)})))()}),[setState]);return{handleError:(0,react.useCallback)((function(_,err){(0,Utils.hE)(pushDialog,{title:t("backend-components.crud.import.errors.file_select"),message:err,buttons:[{text:t("common.buttons.ok"),autoFocus:!0}]})}),[pushDialog,t]),files:state.files,accept:".xlsx",maxFiles:1,onChange:handleChange}},Step1LoadData=function Step1LoadData(props){var state=props.state,howTo=props.howTo,fileUploadProps=useImportStep1FileUploadProps(props);return(0,jsx_runtime.jsxs)(Grid.Z,{container:!0,direction:"column",justify:"space-between",alignItems:"stretch",wrap:"nowrap",style:{height:"100%"},spacing:2,children:[howTo&&(0,jsx_runtime.jsx)(Grid.Z,{item:!0,children:(0,jsx_runtime.jsx)(HowToBox.Z,{labels:howTo})}),(0,jsx_runtime.jsx)(Grid.Z,{item:!0,children:(0,jsx_runtime.jsx)(Generic.Z,(0,objectSpread2.Z)((0,objectSpread2.Z)({},fileUploadProps),{},{previewSize:64}))}),state.data.length>0&&!howTo&&(0,jsx_runtime.jsx)(Grid.Z,{item:!0,xs:!0,style:{minHeight:500},children:(0,jsx_runtime.jsx)(GenericDataPreview.Z,{data:state.data})})]})},Import_Step1LoadData=react.memo(Step1LoadData);try{useImportStep1FileUploadProps.displayName="useImportStep1FileUploadProps",useImportStep1FileUploadProps.__docgenInfo={description:"",displayName:"useImportStep1FileUploadProps",props:{model:{defaultValue:null,description:"",name:"model",required:!0,type:{name:"Model<string, PageVisibility, unknown>"}},updateKey:{defaultValue:null,description:"",name:"updateKey",required:!0,type:{name:"string | undefined"}},additionalUpdateKeyFilters:{defaultValue:null,description:"",name:"additionalUpdateKeyFilters",required:!0,type:{name:"Record<string, unknown> | undefined"}},hasImportConfig:{defaultValue:null,description:"",name:"hasImportConfig",required:!0,type:{name:"boolean"}},validate:{defaultValue:null,description:"",name:"validate",required:!0,type:{name:"((record: Record<string, unknown>) => ValidationError | Promise<ValidationError>) | undefined"}},state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"CrudImporterState"}},setState:{defaultValue:null,description:"",name:"setState",required:!0,type:{name:"Dispatch<SetStateAction<CrudImporterState>>"}},howTo:{defaultValue:null,description:"",name:"howTo",required:!1,type:{name:"ReactNode[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/backend-components/CRUD/Import/Step1LoadData.tsx#useImportStep1FileUploadProps"]={docgenInfo:useImportStep1FileUploadProps.__docgenInfo,name:"useImportStep1FileUploadProps",path:"src/backend-components/CRUD/Import/Step1LoadData.tsx#useImportStep1FileUploadProps"})}catch(__react_docgen_typescript_loader_error){}try{Step1LoadData.displayName="Step1LoadData",Step1LoadData.__docgenInfo={description:"",displayName:"Step1LoadData",props:{model:{defaultValue:null,description:"",name:"model",required:!0,type:{name:"Model<string, PageVisibility, unknown>"}},updateKey:{defaultValue:null,description:"",name:"updateKey",required:!0,type:{name:"string | undefined"}},additionalUpdateKeyFilters:{defaultValue:null,description:"",name:"additionalUpdateKeyFilters",required:!0,type:{name:"Record<string, unknown> | undefined"}},hasImportConfig:{defaultValue:null,description:"",name:"hasImportConfig",required:!0,type:{name:"boolean"}},validate:{defaultValue:null,description:"",name:"validate",required:!0,type:{name:"((record: Record<string, unknown>) => ValidationError | Promise<ValidationError>) | undefined"}},state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"CrudImporterState"}},setState:{defaultValue:null,description:"",name:"setState",required:!0,type:{name:"Dispatch<SetStateAction<CrudImporterState>>"}},howTo:{defaultValue:null,description:"",name:"howTo",required:!1,type:{name:"ReactNode[]"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/backend-components/CRUD/Import/Step1LoadData.tsx#Step1LoadData"]={docgenInfo:Step1LoadData.__docgenInfo,name:"Step1LoadData",path:"src/backend-components/CRUD/Import/Step1LoadData.tsx#Step1LoadData"})}catch(__react_docgen_typescript_loader_error){}var Step2ConnectData=__webpack_require__("./src/backend-components/CRUD/Import/Step2ConnectData.tsx"),Step3ValidateReview=__webpack_require__("./src/backend-components/CRUD/Import/Step3ValidateReview.tsx"),Step4Import=__webpack_require__("./src/backend-components/CRUD/Import/Step4Import.tsx"),react_router=__webpack_require__("./node_modules/react-router/index.js"),History=__webpack_require__("./src/framework/History.ts"),IMPORT_STEPS=["backend-components.crud.import.step1","backend-components.crud.import.step2","backend-components.crud.import.step3","backend-components.crud.import.step4"],useStyles=(0,makeStyles.Z)({wrapper:{width:"100%",height:"100%"}},{name:"CcCrudImport"}),isFieldImportable=function isFieldImportable(name,field){var createVisibility=field.visibility.create,editVisibility=field.visibility.edit,visibilityOkay="function"==typeof createVisibility||"function"==typeof editVisibility||!createVisibility.disabled&&!createVisibility.readOnly||!editVisibility.disabled&&!editVisibility.readOnly,typeOkay=null!==field.type.getFilterType();return"id"!==name&&visibilityOkay&&typeOkay},useCrudImportLogic=function useCrudImportLogic(props){var _model$fields$updateK,model=props.model,importConfig=props.importConfig,updateKey=props.updateKey,guided=props.guided&&importConfig,pathname=(0,react_router.TH)().pathname;if(updateKey&&(null===(_model$fields$updateK=model.fields[updateKey])||void 0===_model$fields$updateK||!_model$fields$updateK.filterable))throw new Error("Update key not in model or not filterable");var _useState=(0,react.useState)(0),_useState2=(0,slicedToArray.Z)(_useState,2),activeStep=_useState2[0],setActiveStep=_useState2[1],_useState3=(0,react.useState)({files:[],data:[],conversionScripts:importConfig?Object.fromEntries(Object.entries(importConfig).map((function(_ref){var _ref2=(0,slicedToArray.Z)(_ref,2);return[_ref2[0],{script:_ref2[1],status:"pending",error:null}]}))):{},validationPassed:!1,importDone:!1}),_useState4=(0,slicedToArray.Z)(_useState3,2),state=_useState4[0],setState=_useState4[1],hasImportConfig=!!importConfig,next=(0,react.useCallback)((function(){return setActiveStep((function(prev){return prev+(0==prev&&guided?2:1)}))}),[guided]),prev=(0,react.useCallback)((function(){return setActiveStep((function(prev){return prev-(2==prev&&guided?2:1)}))}),[guided]),finish=(0,react.useCallback)((function(){History.BE.push(pathname.substr(0,pathname.lastIndexOf("/")))}),[pathname]);return{guided:guided,activeStep:activeStep,state:state,setState:setState,hasImportConfig:hasImportConfig,next:next,prev:prev,finish:finish}},CrudImport=function CrudImport(props){var classes=useStyles(),t=(0,useCCTranslations.ZP)().t,updateKeyAdditionalFilters=props.updateKeyAdditionalFilters,howTo=props.howTo,model=props.model,updateKey=props.updateKey,validate=props.validate,_useCrudImportLogic=useCrudImportLogic(props),guided=_useCrudImportLogic.guided,activeStep=_useCrudImportLogic.activeStep,state=_useCrudImportLogic.state,setState=_useCrudImportLogic.setState,hasImportConfig=_useCrudImportLogic.hasImportConfig,next=_useCrudImportLogic.next,prev=_useCrudImportLogic.prev,finish=_useCrudImportLogic.finish;return(0,jsx_runtime.jsxs)(Grid.Z,{container:!0,direction:"column",justify:"space-between",alignItems:"stretch",spacing:2,wrap:"nowrap",className:classes.wrapper,children:[(0,jsx_runtime.jsx)(Grid.Z,{item:!0,children:(0,jsx_runtime.jsx)(Stepper.Z,{activeStep:guided&&activeStep>1?activeStep-1:activeStep,children:IMPORT_STEPS.filter((function(label,index){return!(guided&&1===index)})).map((function(label,index){return(0,jsx_runtime.jsx)(Step.Z,{children:(0,jsx_runtime.jsx)(StepLabel.Z,{children:t(label)})},index.toString(16))}))})}),(0,jsx_runtime.jsxs)(Grid.Z,{item:!0,xs:!0,children:[0===activeStep&&(0,jsx_runtime.jsx)(Import_Step1LoadData,{model:model,howTo:guided?howTo:void 0,updateKey:updateKey,additionalUpdateKeyFilters:updateKeyAdditionalFilters,hasImportConfig:hasImportConfig,validate:validate,state:state,setState:setState}),1===activeStep&&(0,jsx_runtime.jsx)(Step2ConnectData.Z,{model:model,updateKey:updateKey,additionalUpdateKeyFilters:updateKeyAdditionalFilters,hasImportConfig:hasImportConfig,validate:validate,state:state,setState:setState}),2===activeStep&&(0,jsx_runtime.jsx)(Step3ValidateReview.Z,{model:model,updateKey:updateKey,additionalUpdateKeyFilters:updateKeyAdditionalFilters,hasImportConfig:hasImportConfig,validate:validate,state:state,setState:setState}),3===activeStep&&(0,jsx_runtime.jsx)(Step4Import.Z,{model:model,updateKey:updateKey,additionalUpdateKeyFilters:updateKeyAdditionalFilters,hasImportConfig:hasImportConfig,validate:validate,state:state,setState:setState})]}),(0,jsx_runtime.jsx)(Grid.Z,{item:!0,children:(0,jsx_runtime.jsxs)(Grid.Z,{container:!0,spacing:2,children:[3!==activeStep&&(0,jsx_runtime.jsx)(Grid.Z,{item:!0,children:(0,jsx_runtime.jsx)(Button.Z,{variant:"contained",disabled:0===activeStep||activeStep>=3,onClick:prev,children:t("common.buttons.back")})}),(0,jsx_runtime.jsx)(Grid.Z,{item:!0,children:(0,jsx_runtime.jsx)(Button.Z,{variant:"contained",disabled:2===activeStep&&!state.validationPassed||3===activeStep&&!state.importDone,onClick:3===activeStep?finish:next,children:t(3===activeStep?"common.buttons.finish":"common.buttons.next")})})]})})]})},CRUD_Import=react.memo(CrudImport);try{useCrudImportLogic.displayName="useCrudImportLogic",useCrudImportLogic.__docgenInfo={description:"",displayName:"useCrudImportLogic",props:{model:{defaultValue:null,description:"The model to import for",name:"model",required:!0,type:{name:"Model<KeyT, VisibilityT, CustomT>"}},importConfig:{defaultValue:null,description:"The importer config\nRecord<Field, JavaScript>\n@remarks Disables step 2",name:"importConfig",required:!1,type:{name:"Partial<Record<KeyT, string>>"}},updateKey:{defaultValue:null,description:"The field used to determine an ID of an existing record for purpose of updating that existing record\ninstead of creating a new record.",name:"updateKey",required:!1,type:{name:"string"}},updateKeyAdditionalFilters:{defaultValue:null,description:"Additional filter parameter for backend index calls",name:"updateKeyAdditionalFilters",required:!1,type:{name:"Record<string, unknown>"}},howTo:{defaultValue:null,description:"How-to information",name:"howTo",required:!1,type:{name:"ReactNode[]"}},validate:{defaultValue:null,description:"Additional validation callback for imported records\n@param record The record to validate\n@returns Validation errors",name:"validate",required:!1,type:{name:"((record: Record<string, unknown>) => ValidationError | Promise<ValidationError>)"}},guided:{defaultValue:null,description:"Guided version",name:"guided",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/backend-components/CRUD/Import/index.tsx#useCrudImportLogic"]={docgenInfo:useCrudImportLogic.__docgenInfo,name:"useCrudImportLogic",path:"src/backend-components/CRUD/Import/index.tsx#useCrudImportLogic"})}catch(__react_docgen_typescript_loader_error){}try{Import.displayName="Import",Import.__docgenInfo={description:"",displayName:"Import",props:{model:{defaultValue:null,description:"The model to import for",name:"model",required:!0,type:{name:"Model<KeyT, VisibilityT, CustomT>"}},importConfig:{defaultValue:null,description:"The importer config\nRecord<Field, JavaScript>\n@remarks Disables step 2",name:"importConfig",required:!1,type:{name:"Partial<Record<KeyT, string>>"}},updateKey:{defaultValue:null,description:"The field used to determine an ID of an existing record for purpose of updating that existing record\ninstead of creating a new record.",name:"updateKey",required:!1,type:{name:"string"}},updateKeyAdditionalFilters:{defaultValue:null,description:"Additional filter parameter for backend index calls",name:"updateKeyAdditionalFilters",required:!1,type:{name:"Record<string, unknown>"}},howTo:{defaultValue:null,description:"How-to information",name:"howTo",required:!1,type:{name:"ReactNode[]"}},validate:{defaultValue:null,description:"Additional validation callback for imported records\n@param record The record to validate\n@returns Validation errors",name:"validate",required:!1,type:{name:"((record: Record<string, unknown>) => ValidationError | Promise<ValidationError>)"}},guided:{defaultValue:null,description:"Guided version",name:"guided",required:!0,type:{name:"boolean"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/backend-components/CRUD/Import/index.tsx#Import"]={docgenInfo:Import.__docgenInfo,name:"Import",path:"src/backend-components/CRUD/Import/index.tsx#Import"})}catch(__react_docgen_typescript_loader_error){}},"./src/utils/sleep.ts":function(__unused_webpack_module,__webpack_exports__){"use strict";__webpack_exports__.Z=function sleep(ms){return new Promise((function(resolve){window.setTimeout(resolve,ms)}))}},"./src/utils/useAsyncMemo.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";var _home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/regenerator/index.js"),_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0__),react__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/react/index.js");__webpack_exports__.Z=function useAsyncMemo(factory,dependencies){var keepPreviousResult=arguments.length>2&&void 0!==arguments[2]&&arguments[2],_useState=(0,react__WEBPACK_IMPORTED_MODULE_1__.useState)(null),_useState2=(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_slicedToArray_js__WEBPACK_IMPORTED_MODULE_2__.Z)(_useState,2),value=_useState2[0],setValue=_useState2[1];return(0,react__WEBPACK_IMPORTED_MODULE_1__.useEffect)((function(){keepPreviousResult||setValue(null),(0,_home_runner_work_react_components_react_components_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_3__.Z)(_home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().mark((function _callee(){return _home_runner_work_react_components_react_components_node_modules_babel_runtime_regenerator_index_js__WEBPACK_IMPORTED_MODULE_0___default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.t0=setValue,_context.next=3,factory();case 3:_context.t1=_context.sent,(0,_context.t0)(_context.t1);case 5:case"end":return _context.stop()}}),_callee)})))()}),dependencies),value}},"?e708":function(){},"?58fb":function(){},"?20df":function(){}}]);